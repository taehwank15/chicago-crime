---
title: "Chicago Crime Data"
author: "Taehwan Kim"
date: "4/4/2019"
output: html_document
---

```{r setup, include=FALSE, cache = TRUE}
knitr::opts_chunk$set(echo = FALSE)

# Load in libraries
library(fs)
library(janitor)
library(lubridate)
library(ggthemes)
library(scales)
library(tidyverse)

# Download and initialize data
chicago <- read_csv("https://data.cityofchicago.org/api/views/ijzp-q8t2/rows.csv?accessType=DOWNLOAD", col_types = cols(
                      .default = col_character(),
                      ID = col_double(),
                      Arrest = col_logical(),
                      Domestic = col_logical(),
                      Ward = col_double(),
                      `Community Area` = col_double(),
                      `X Coordinate` = col_double(),
                      `Y Coordinate` = col_double(),
                      Year = col_double(),
                      Latitude = col_double(),
                      Longitude = col_double())) %>% 
  # Rename columns in snake case
  clean_names()

# Cast date from character to POSIXlt
chicago$date <- as.POSIXct(chicago$date, format = "%m/%d/%Y %I:%M:%S %p")


```

# Final Project Milestone 4/5

### Data

I got the data of chicago crime from the [City of Chicago's Open Data Poral]("https://data.cityofchicago.org/") that was required by Mayor Rahm Emmanuel. The data is updated everyday and lists crime data from 2001, so I just used one date (4/4/2019) as an end point. The data lists every reported crime since the start date and shows information about it like date; time; type of crime reported; whether an arrest was made; and location.

I plan on running multiple analyses of the data, trying to see the relation between arrest rate with race, a map with crime that shows up by time and date (per year possibly because of how much data there is), seeing how and which type of crime changed over time, arrest rates per crime type.

### Graph

```{r graph}


# Calculate data for graph showing reported cases per year
chicago %>%
  
  # Only use year of date
  mutate(year = year(date)) %>% 
  
  # Because 2019 is not finished, graph would be misleading if included
  filter(year < 2019) %>% 
  
  # Calculate number of cases per year
  group_by(year) %>%
  summarize(cases = n()) %>%
  
  # Graph cases
  ggplot(aes(x = year, y = cases)) +
  geom_line() +
  theme_wsj() +
  labs(title = "Number of Reported Cases",
       subtitle = "In Chicago, IL from 2001 to 2018",
       caption = "Source: data.cityofchicago.org") +
  xlab("Year") +
  ylab("Number of Reported Cases") +
  scale_y_continuous(breaks = seq(0:500000),labels = comma) +
  scale_x_continuous(breaks = c(2001, 2004, 2007, 2010, 2013, 2016, 2018),
                     labels = c("2001", "2004", "2007", "2010", "2013", "2016", "2018"))
  

```

